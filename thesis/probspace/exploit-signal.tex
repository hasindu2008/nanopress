\section{Exploiting the Signal}

As discussed in Section
\ref{sec:data:char},
there are several common characteristics between reads which can be exploited to gain more compression.

\subsection{The Stall}

To begin with, recall that the stall is the section of a read which occurs at the beginning between the surge and pre-adapter surge. It is thought to occur due to the motor protein `stalling' before it begins to unwind the molecule.
% See Figure \ref{}
It consists of hundreds to thousands of data points which oscillate with little variation around the read's median.

One approach consists of subtracting the minimum point in the stall from all other stall points, then applying rc-vbbe21. The idea is that the stall has a small variation already so taking the zig-zag delta transformation doesn't improve compression over this section.

\subsection{Separating the Jumps and Flats}

The large majority of the data consists of DNA sections so any gains in
compression discovered by understanding this type of section should
result in the largest gains overall.

The problem is that there are a lot of apparent irregularities in the DNA
sections as is expected with information saturated sensor data. Furthermore, the
zig-zag delta transformation is quite fast and already has a readily
compressible distribution making it difficult to outperform. However, one
observation we could take advantage of is the fact that the signal tends to
suddenly move up or down between sections which oscillate around some level.
Let's call these sudden movements up and down, `jumps' and `falls' respectively.
Whilst `flats' will be our name for sections which oscillate around some level.
Since flats oscillate around some level, they should have small zig-zag deltas.
On the other hand, jumps and flats should have larger positive and negative
deltas respectively.

Consider separating the read into two general distributions: the absolute deltas
of jumps and falls, and the zig-zag deltas of flats. This should benefit
compression since each distribution will have its own unique properties which
require different compression strategies. However, storing the metadata
necessary for reconstruction of the read from the distributions may be too much
of a cost for any benefits received.

Let's define a jump or fall as
\begin{itemize}
	\item a sequence of length $m\ge 2$ which is
	\item strictly increasing or decreasing respectively with
	\item at least one absolute delta greater than some $\epsilon$ ($\exists i\; s.t.|\delta_i|>\epsilon$).
\end{itemize}

The idea with the third restriction is to actually capture sudden movements
rather than slowly increasing or decreasing sections, without which all non-zero
deltas would be labelled part of a jump or fall. The choice of which $\epsilon$
depends on the data and how much separation between flats and jumps or falls you
desire.

\input{plots/epsilon}
