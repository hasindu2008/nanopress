\chapter*{Appendix} \label{chap:appendix}

\section{Subsequence Searching}

%TODO sort this out better

Using the arithmetico-geometric series formula
\label{app:phi}
\begin{align*}
	\phi_n &= O(n) + 2\sum_{1\le k\le n-1}3^{k-1}O(n-k)\\
&= O(n) + 2\left(\frac{O(n-1) - 0}{1-3} - \frac{3}{(1-3)^2}(1-3^{n-1})\right)\\
&= O(n) - O(n-1) + \frac{3}{2}(3^{n-1}-1)\\
&= O(n) - O(n-1) + \frac{3^n}{2} - \frac{3}{2}
\end{align*}

\label{app:xi}
\begin{align*}
	\xi_n &= 2\times 3^{n-2}+\sum_{1\le k\le n-2}3^{k-1}(n-k)\\
	&= 2\times 3^{n-2} + \frac{(n-1)-3^{n-2}}{1-3}-\frac{3}{(1-3)^2}(1-3^{n-2})\\
	&= 2\times 3^{n-2} + \frac{3^{n-2}-n+1}{2}+\frac{3}{4}(3^{n-2}-1)\\
	&= 2\times 3^{n-2} + \frac{5}{4}\times 3^{n-2}-\frac{n-1}{2}-\frac{3}{4}\\
	&= 2\times 3^{n-2}+\frac{5}{4}\times 3^{n-2}-\frac{2n+1}{4}
\end{align*}
